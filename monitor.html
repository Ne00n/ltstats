<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Statistics</title><script src="https://cdn.jsdelivr.net/gh/lukastautz/ltstats@v1.0/apexcharts.min.js" integrity="sha256-TOd448JQDA7fihR5yvia3panY32rjYrcc8jyRSpvrtk=" crossorigin="anonymous"></script><style>a{text-decoration:none}a:hover{text-decoration:underline}.controls,button,h1,footer{user-select:none}button,h1 a{cursor:pointer;color:#ecf0f1;margin-right:.5rem}button,h1{background-color:#2c3e50}.chart,body{padding:15px}.chart,.item,pre{background-color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.1)}.title,.value{font-weight:700}*{margin:0;padding:0;box-sizing:border-box;font-family:sans-serif}body{background-color:#ebebeb;color:#333}.dashboard{max-width:100%;margin:0 auto}.chart,.controls,h1{margin-bottom:15px}h1{color:#ecf0f1;padding:12px;font-size:1.5rem;border-radius:5px}h1 a:nth-of-type(2){float:right;margin-right:0}.controls{display:flex;flex-wrap:wrap;gap:5px;margin-top:1rem}button{border:none;padding:8px 12px;border-radius:5px;font-size:.9rem;transition:background-color .15s}button:hover{background-color:#34495e}button.active{background-color:#1c6bb8}button:disabled{opacity:.5;cursor:not-allowed}.navigation{margin-left:auto}.chart{border-radius:5px}#offline-text{margin-left:1rem;color:#f44336}.item,pre{padding:8px;border-radius:3px}.error,.offline .status-dot{background-color:#f44336}.title{margin-bottom:4px}.value{color:#00a0cc}.error{color:#fff;padding:10px;border-radius:5px;margin-bottom:15px}footer,footer a{text-align:center;margin-top:1rem;color:#999!important;font-size:.7rem;font-weight:400}footer a:hover{color:#666!important}@media (prefers-color-scheme:dark){body{background-color:#121212;color:#e0e0e0}.chart,.item,pre{background-color:#282828}button,h1{background-color:#233443}footer,footer a{color:#555!important}footer a:hover{color:#777!important}}.apexcharts-svg{padding-top:.25rem}.status-dot{display:inline-block;width:1rem;height:1rem;border-radius:50%;margin-left:1rem;background-color:#4caf50}.hidden,pre:empty{display:none}.container-div{display:grid;grid-template-columns:1fr auto;align-items:start}pre{width:fit-content;height:fit-content;position:relative}@supports (container-type:inline-size){.container{container-type:inline-size}@container (inline-size < 95rem){.container-div{grid-template-columns:1fr}pre{width:100%;margin-top:1rem}}}@supports not (container-type:inline-size){@media (aspect-ratio < 16/9){.container-div{grid-template-columns:1fr}pre{width:100%;margin-top:1rem}}}.container-content{display:flex;flex-direction:column;gap:10px;min-width:0}.row{display:grid;gap:10px;align-items:stretch}.row-small{grid-template-columns:repeat(auto-fill,minmax(min(100%,10.5rem),1fr))}.row-large{grid-template-columns:repeat(auto-fill,minmax(min(100%,13rem),1fr))}</style></head><body><div class="dashboard"><h1 id="top" class="hidden"><a onclick="window.history.back();" title="Back">&larr;</a> <span id="title">Loading</span> <span class="status-dot"></span><span id="offline-text"></span><a href="/admin">Admin area</a></h1><div class="error" style="display:none">Fetching data failed!</div><div class="container"><div class="container-div"><div class="container-content"><div class="row row-small" id="details"></div><div class="row row-small" id="stats"></div><div class="row row-large" id="io-stats"></div></div><pre id="notes"></pre></div></div></div><div class="controls"><div><button data-period="6h" class="active">6 hours</button><button data-period="12h">12 hours</button><button data-period="24h">24 hours</button><button data-period="3d">3 days</button><button data-period="7d">7 days</button><button data-period="14d">14 days</button><button data-period="28d">28 days</button><button data-period="3m">3 months</button><button data-period="6m">6 months</button><button data-period="1y">1 year</button><button data-period="2y">2 years</button></div><div class="navigation"><button id="older">← Older</button><button id="newer" disabled>Newer →</button></div></div><div class="chart"><div id="percentChart"></div></div><div class="chart"><div id="networkChart"></div></div><div class="chart"><div id="diskChart"></div></div><script>var page=window.location.pathname.replace("/monitor/",""),state=(page.endsWith("/")&&(page=page.slice(0,-1)),{period:"6h",back:0,data:{},charts:{},colors:{cpu:"#0c4d85",iowait:"#fac800",steal:"#fa0000",ram:"#00ff00",swap:"#40e0d0",disk:"#8b75d7",rx:"#427a2a",tx:"#a67016",read:"#326b41",write:"#db624d"},dark:window.matchMedia("(prefers-color-scheme:dark)").matches}),sizes="KMGTPE";function formatBytes(t){var e;return 0===t?"0 B":(e=Math.floor(Math.log(t)/Math.log(1024)),parseFloat((t/Math.pow(1024,e)).toFixed(2))+" "+(0<e?sizes[e-1]:"")+"B")}function formatNetworkSpeed(t){var e;return 0===t?"0 bit/s":(t=8*t,e=Math.floor(Math.log(t)/Math.log(1e3)),parseFloat((t/Math.pow(1e3,e)).toFixed(2))+" "+(0<e?sizes[e-1]:"")+"bit/s")}state.dark||(state.colors.ram="#008a00",state.colors.swap="#1d9f95");var formatUptime=t=>`${Math.floor(t/86400)}d ${Math.floor(t%86400/3600)}h ${Math.floor(t%3600/60)}m`,$=t=>document.getElementById(t);function merge(t,e){for(key of Object.keys(e))void 0===t[key]?t[key]=e[key]:merge(t[key],e[key])}function initializeCharts(){var e={chart:{type:"line",height:350,toolbar:{show:!0,tools:{download:!1,selection:!1,zoom:!0,zoomin:!1,zoomout:!1,pan:!0,reset:!0}},animations:{enabled:!0}},dataLabels:{enabled:!1},stroke:{curve:"straight",width:2},grid:{borderColor:state.dark?"#555":"#e0e0e0"},xaxis:{type:"datetime",labels:{datetimeUTC:!1}},tooltip:{x:{format:"dd MMM HH:mm"}},theme:{mode:state.dark?"dark":"light"},legend:{position:"top",horizontalAlign:"right",onItemClick:{toggleDataSeries:!0}},series:[],title:{align:"left"},yaxis:{min:0},markers:{size:0}};[[{title:{text:"Usage (%)"},yaxis:{title:{text:"Usage (%)"}}},"resources","percentChart"],[{title:{text:"Network Usage"},yaxis:{title:{text:"Speed"},labels:{formatter:formatNetworkSpeed}},tooltip:{y:{formatter:formatNetworkSpeed}}},"network","networkChart"],[{title:{text:"Disk IO"},yaxis:{title:{text:"Speed"},labels:{formatter:t=>formatBytes(t)+"/s"}},tooltip:{y:{formatter:t=>formatBytes(t)+"/s"}}},"disk","diskChart"]].forEach(t=>{merge(t[0],e),state.charts[t[1]]=new ApexCharts($(t[2]),t[0]),state.charts[t[1]].render()})}function updateCharts(){var o=[],r=0,i=document.getElementsByClassName("chart");Object.keys(state.data.data).forEach(a=>state.data.data[a].forEach((t,e)=>{void 0===o[e]&&(o[e]=[]),o[e].push([1e3*a,t])})),[{graph:state.charts.resources,data:[[0,"CPU",state.colors.cpu],[1,"IOwait",state.colors.iowait],[2,"Steal",state.colors.steal],[3,"RAM",state.colors.ram],[4,"Swap",state.colors.swap],[5,"Disk",state.colors.disk]]},{graph:state.charts.network,data:[[6,"Download",state.colors.rx],[7,"Upload",state.colors.tx]]},{graph:state.charts.disk,data:[[8,"Read IO",state.colors.read],[9,"Write IO",state.colors.write]]}].forEach((t,e)=>{var a=[],s=[];t.data.forEach(t=>{!0!==state.data.hidden[t[0]]&&(a.push({name:t[1],data:o[r]}),s.push(t[2]),++r)}),0===a.length?i[e].style.display="none":(i[e].style="",t.graph.updateOptions({series:a,colors:s}))}),updateStatistics()}function updateStatistics(){Object.keys(state.data.data);var s=$("stats"),o=0,t=t=>2!==state.data.details.length&&state.data.details[t];s.innerHTML="",[{cur:t(5),name:"CPU",type:0,color:state.colors.cpu},{cur:t(6),name:"IOwait",type:0,color:state.colors.iowait},{cur:t(7),name:"Steal",type:0,color:state.colors.steal},{cur:t(9),name:"RAM",type:0,color:state.colors.ram},{cur:t(11),name:"Swap",type:0,color:state.colors.swap},{cur:t(13),name:"Disk",type:0,color:state.colors.disk},{cur:t(14),name:`Download (${state.data.traffic?formatBytes(state.data.traffic[0]):""})`,type:1,color:state.colors.rx},{cur:t(15),name:`Upload (${state.data.traffic?formatBytes(state.data.traffic[1]):""})`,type:1,color:state.colors.tx},{cur:t(16),name:`Read IO (${state.data.io?formatBytes(state.data.io[0]):""})`,type:2,color:state.colors.read},{cur:t(17),name:`Write IO (${state.data.io?formatBytes(state.data.io[1]):""})`,type:2,color:state.colors.write}].forEach((t,e)=>{var a;t.name.startsWith("Download")&&((s=$("io-stats")).innerHTML=""),state.data.hidden[e]||((e=document.createElement("div")).className="item",a=[t=>t.toFixed(2)+"%",t=>formatNetworkSpeed(t),t=>formatBytes(t)+"/s"][t.type],e.innerHTML=`<div class="title" style="color:${t.color}">${t.name}</div><div>Average: <span class="value">${a(state.data.avg[o])}</span></div><div>Maximum: <span class="value">${a(state.data.max[o])}</span></div>`,2!=state.data.details.length&&(e.innerHTML+=`<div>Current: <span class="value">${a(t.cur)}</span></div>`),s.appendChild(e),++o)})}var offlineString=t=>null===t?"Offline":t<3600?`Offline for ${Math.floor(t/60)} minutes`:`Offline for ${Math.floor(t/3600)} hours, ${Math.floor(t%3600/60)} minutes`;function fetchData(){fetch(`/api/data/${page}/${state.period}/`+state.back).then(t=>{if(200!=t.status)throw new Error;return t.json()}).then(t=>{document.body.querySelector(".error").style.display="none",state.data=t,updateCharts();var e,a,s,o,r,i=(t,e,a,s)=>`<div class="item"><div class="title">All-time ${t}</div><b>${a}</b>: <span class="value">${formatBytes(e[2])}</span><br><b>${s}</b>: <span class="value">${formatBytes(e[3])}</span></div>`,l="",n="Statistics - "+t.details[0],d=(t,e)=>`<div class="item"><div class="title">${t}</div><span class="value">${e}</span></div>`;t.traffic&&(l+=i("traffic",t.traffic,"RX","TX")),t.io&&(l+=i("IO",t.io,"Read","Written")),$("title").innerHTML=n,document.title=n,2===t.details.length?($("top").setAttribute("class","offline"),$("offline-text").innerHTML=offlineString(t.details[1])):([,i,n,e,a,,,,s,,o,,r]=t.details,$("offline-text").innerHTML="",-1!==i&&(l+=d("Kernel",i)),-1!==e?l+=d(e+" core"+(1===e?"":"s"),-1!==n?`<span style="font-size:.7rem">${n}</span>`:""):-1!==n&&(l+=d("? core(s)",`<span style="font-size:.7rem">${n}</span>`)),-1!==a&&(l+=d("Uptime",formatUptime(a))),-1===s&&-1===o&&-1===r||(l+='<div class="item">',[[s,"RAM"],[o,"Swap"],[r,"Disk"]].forEach(t=>{-1!==t[0]&&(l+=`<b>${t[1]}</b>: <span class="value">${formatBytes(t[0])}</span><br>`)})),$("top").setAttribute("class","")),t.notes&&($("notes").innerHTML=t.notes),$("details").innerHTML=l,$("newer").disabled=0===state.back}).catch(()=>document.body.querySelector(".error").style.display="block")}function initialize(){window.addEventListener("wheel",function(t){t.stopImmediatePropagation()},!0),initializeCharts();var e=document.querySelectorAll("[data-period]");e.forEach(t=>{t.addEventListener("click",()=>{e.forEach(t=>t.classList.remove("active")),t.classList.add("active"),state.period=t.getAttribute("data-period"),state.back=0,fetchData()})}),$("older").addEventListener("click",()=>{++state.back,fetchData()}),$("newer").addEventListener("click",()=>{0<state.back&&(--state.back,fetchData())}),fetchData(),setInterval(()=>{0!==state.back||"string"==typeof document.visibilityState&&"hidden"===document.visibilityState||fetchData()},3e4)}document.addEventListener("DOMContentLoaded",initialize),document.addEventListener("visibilitychange",()=>{"string"==typeof document.visibilityState&&"hidden"!==document.visibilityState&&fetchData()}),document.addEventListener("keydown",t=>{"F5"===t.key&&(t.preventDefault(),fetchData())});</script><footer>Powered by <a href="https://ltstats.de">LTstats</a></footer></body></html>